kind: pipeline
type: docker
name: ds_pipeline

platform:
  os: linux
  arch: amd64

steps:
- name: build
  image: docker
  commands:
  - docker run --rm --gpus all nvidia/cuda nvidia-smi
  - docker build -t ds_gstreamer_pipeline

- name: deploy
  image: docker
  commands:
  - docker run --gpus all --name=ds_gstreamer_pipeline ds_gstreamer_pipeline
  when:
    branch: staging
  depends_on:
  - build
